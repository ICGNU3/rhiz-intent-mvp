(()=>{var e={};e.id=8947,e.ids=[8947],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},57310:e=>{"use strict";e.exports=require("url")},95095:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>r.a,__next_app__:()=>h,originalPathname:()=>m,pages:()=>d,routeModule:()=>p,tree:()=>l});var a=s(67096),i=s(16132),n=s(37284),r=s.n(n),o=s(32564),c={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>o[e]);s.d(t,c);let l=["",{children:["voice-chat",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,42318)),"/Users/israelwilson/Developer/rhiz-intent-mvp/apps/web/app/voice-chat/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,71825)),"/Users/israelwilson/Developer/rhiz-intent-mvp/apps/web/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,9291,23)),"next/dist/client/components/not-found-error"]}],d=["/Users/israelwilson/Developer/rhiz-intent-mvp/apps/web/app/voice-chat/page.tsx"],m="/voice-chat/page",h={require:s,loadChunk:()=>Promise.resolve()},p=new a.AppPageRouteModule({definition:{kind:i.x.APP_PAGE,page:"/voice-chat/page",pathname:"/voice-chat",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},12818:(e,t,s)=>{Promise.resolve().then(s.bind(s,34093))},34093:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>VoiceChatPage});var a=s(30784),i=s(9885),n=s(95555),r=s(20599),o=s(61890),c=s(5987),l=s(18310),d=s(75951),m=s(89093),h=s(97151),p=s(31870);let VoiceStreamManager=class VoiceStreamManager{constructor(e,t){this.wsUrl=e,this.mediaRecorder=null,this.audioContext=null,this.stream=null,this.ws=null,this.isRecording=!1,this.chunks=[],this.config={sampleRate:16e3,channels:1,bitDepth:16,chunkSize:1024},this.config={...this.config,...t}}async startStreaming(){try{p.k.info("Starting real-time voice streaming",{component:"voice-streaming"}),this.stream=await navigator.mediaDevices.getUserMedia({audio:{sampleRate:this.config.sampleRate,channelCount:this.config.channels,echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0}}),this.ws=new WebSocket(this.wsUrl),this.setupWebSocketHandlers(),this.mediaRecorder=new MediaRecorder(this.stream,{mimeType:"audio/webm;codecs=opus",audioBitsPerSecond:16e3}),this.setupMediaRecorderHandlers(),this.mediaRecorder.start(100),this.isRecording=!0,p.k.info("Voice streaming started successfully",{component:"voice-streaming"})}catch(e){throw p.k.error("Failed to start voice streaming",e,{component:"voice-streaming"}),e}}setupWebSocketHandlers(){this.ws&&(this.ws.onopen=()=>{p.k.info("WebSocket connection established",{component:"voice-streaming"})},this.ws.onmessage=e=>{try{let t=JSON.parse(e.data);this.handleServerMessage(t)}catch(e){p.k.error("Failed to parse WebSocket message",e,{component:"voice-streaming"})}},this.ws.onerror=e=>{p.k.error("WebSocket error",e,{component:"voice-streaming"})},this.ws.onclose=()=>{p.k.info("WebSocket connection closed",{component:"voice-streaming"})})}setupMediaRecorderHandlers(){this.mediaRecorder&&(this.mediaRecorder.ondataavailable=e=>{e.data.size>0&&(this.chunks.push(e.data),this.sendAudioChunk(e.data))},this.mediaRecorder.onstop=()=>{p.k.info("MediaRecorder stopped",{component:"voice-streaming"})},this.mediaRecorder.onerror=e=>{p.k.error("MediaRecorder error",e,{component:"voice-streaming"})})}async sendAudioChunk(e){if(this.ws&&this.ws.readyState===WebSocket.OPEN)try{let t=await e.arrayBuffer(),s=btoa(String.fromCharCode(...new Uint8Array(t)));this.ws.send(JSON.stringify({type:"audio_chunk",data:s,timestamp:Date.now(),format:"webm"}))}catch(e){p.k.error("Failed to send audio chunk",e,{component:"voice-streaming"})}}handleServerMessage(e){switch(e.type){case"transcription":this.emit("transcription",e);break;case"ai_response":this.emit("ai_response",e);break;case"audio_response":this.playAudioResponse(e.audio);break;case"error":p.k.error("Server error",e.error,{component:"voice-streaming"});break;default:p.k.warn("Unknown message type",{component:"voice-streaming",type:e.type})}}async playAudioResponse(e){try{let t=atob(e),s=new Uint8Array(t.length);for(let e=0;e<t.length;e++)s[e]=t.charCodeAt(e);let a=new Blob([s],{type:"audio/mpeg"}),i=URL.createObjectURL(a),n=new Audio(i);await n.play(),URL.revokeObjectURL(i)}catch(e){p.k.error("Failed to play audio response",e,{component:"voice-streaming"})}}stopStreaming(){p.k.info("Stopping voice streaming",{component:"voice-streaming"}),this.isRecording=!1,this.mediaRecorder&&(this.mediaRecorder.stop(),this.mediaRecorder=null),this.stream&&(this.stream.getTracks().forEach(e=>e.stop()),this.stream=null),this.ws&&(this.ws.close(),this.ws=null),this.chunks=[]}emit(e,t){window.dispatchEvent(new CustomEvent(`voice-stream:${e}`,{detail:t}))}isStreaming(){return this.isRecording}getConnectionStatus(){if(!this.ws)return"disconnected";switch(this.ws.readyState){case WebSocket.CONNECTING:return"connecting";case WebSocket.OPEN:return"connected";default:return"disconnected"}}};function useVoiceStream(e){let[t,s]=(0,i.useState)(!1),[a,n]=(0,i.useState)("disconnected"),[r,o]=(0,i.useState)(""),[c,l]=(0,i.useState)(""),d=(0,i.useRef)(null);(0,i.useEffect)(()=>{d.current=new VoiceStreamManager(e);let handleTranscription=e=>{o(e.detail.text)},handleAiResponse=e=>{l(e.detail.text)};return window.addEventListener("voice-stream:transcription",handleTranscription),window.addEventListener("voice-stream:ai_response",handleAiResponse),()=>{window.removeEventListener("voice-stream:transcription",handleTranscription),window.removeEventListener("voice-stream:ai_response",handleAiResponse),d.current?.stopStreaming()}},[e]);let startStreaming=async()=>{try{await d.current?.startStreaming(),s(!0)}catch(e){console.error("Failed to start streaming:",e)}};return{isStreaming:t,connectionStatus:a,transcription:r,aiResponse:c,startStreaming,stopStreaming:()=>{d.current?.stopStreaming(),s(!1)}}}function VoiceChatPage(){let[e,t]=(0,i.useState)([]),[s,u]=(0,i.useState)(!1),[x,g]=(0,i.useState)("professional"),[v,w]=(0,i.useState)(!1),[f,y]=(0,i.useState)(null),b=(0,i.useRef)(null);(0,i.useRef)(null);let j=`wss://${window.location.host}/api/voice/stream`,{isStreaming:k,connectionStatus:S,transcription:N,aiResponse:R,startStreaming:C,stopStreaming:_}=useVoiceStream(j);(0,i.useEffect)(()=>{b.current?.scrollIntoView({behavior:"smooth"})},[e]),(0,i.useEffect)(()=>{N&&N.trim()&&addMessage("user",N)},[N]),(0,i.useEffect)(()=>{R&&R.trim()&&addMessage("ai",R)},[R]),(0,i.useEffect)(()=>{u("connected"===S),"disconnected"===S&&k&&y("Connection lost. Please try reconnecting.")},[S,k]);let addMessage=(e,s,a)=>{let i={id:crypto.randomUUID(),type:e,text:s,timestamp:new Date,audioUrl:a};t(e=>[...e,i])},handleStartConversation=async()=>{try{y(null),await C(),addMessage("ai","Hello! I'm your AI networking assistant. I'm here to help you build meaningful connections. What would you like to discuss?"),p.k.info("Voice conversation started",{component:"voice-chat"})}catch(e){y("Failed to start conversation. Please check your microphone permissions."),p.k.error("Failed to start voice conversation",e,{component:"voice-chat"})}};return a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-4",children:(0,a.jsxs)("div",{className:"max-w-4xl mx-auto space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Voice Chat"}),a.jsx("p",{className:"text-gray-600",children:"Real-time AI-powered networking conversations"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[a.jsx("div",{className:`w-3 h-3 rounded-full ${(()=>{switch(S){case"connected":return"bg-green-500";case"connecting":return"bg-yellow-500";default:return"bg-red-500"}})()}`}),a.jsx("span",{className:"text-sm text-gray-600",children:(()=>{switch(S){case"connected":return"Connected";case"connecting":return"Connecting...";default:return"Disconnected"}})()})]}),a.jsx(o.C,{variant:"outline",className:"text-xs",children:x.charAt(0).toUpperCase()+x.slice(1)}),a.jsx(n.z,{variant:"outline",size:"sm",onClick:()=>w(!v),children:a.jsx(c.Z,{className:"w-4 h-4"})})]})]}),v&&(0,a.jsxs)(r.Zb,{children:[a.jsx(r.Ol,{children:a.jsx(r.ll,{className:"text-lg",children:"Voice Settings"})}),a.jsx(r.aY,{className:"space-y-4",children:(0,a.jsxs)("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Voice Personality"}),a.jsx("div",{className:"grid grid-cols-2 gap-2 mt-2",children:["professional","friendly","enthusiastic","calm"].map(e=>a.jsx(n.z,{variant:x===e?"default":"outline",size:"sm",onClick:()=>g(e),children:e.charAt(0).toUpperCase()+e.slice(1)},e))})]})})]}),f&&a.jsx(r.Zb,{className:"border-red-200 bg-red-50",children:a.jsx(r.aY,{className:"pt-6",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2 text-red-700",children:[a.jsx("span",{className:"text-sm",children:f}),a.jsx(n.z,{variant:"ghost",size:"sm",onClick:()=>y(null),children:"\xd7"})]})})}),a.jsx(r.Zb,{className:"flex-1 min-h-[500px]",children:a.jsx(r.aY,{className:"p-6",children:(0,a.jsxs)("div",{className:"space-y-4 h-[500px] overflow-y-auto",children:[0===e.length?a.jsx("div",{className:"flex items-center justify-center h-full text-gray-500",children:(0,a.jsxs)("div",{className:"text-center",children:[a.jsx(l.Z,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),a.jsx("p",{children:"No messages yet. Start a conversation to begin!"})]})}):e.map(e=>a.jsx("div",{className:`flex ${"user"===e.type?"justify-end":"justify-start"}`,children:(0,a.jsxs)("div",{className:`max-w-[80%] rounded-lg px-4 py-2 ${"user"===e.type?"bg-blue-500 text-white":"bg-gray-100 text-gray-900"}`,children:[a.jsx("p",{className:"text-sm",children:e.text}),a.jsx("p",{className:"text-xs opacity-70 mt-1",children:e.timestamp.toLocaleTimeString()})]})},e.id)),a.jsx("div",{ref:b})]})})}),a.jsx(r.Zb,{children:(0,a.jsxs)(r.aY,{className:"p-6",children:[a.jsx("div",{className:"flex items-center justify-center space-x-4",children:k?(0,a.jsxs)(n.z,{onClick:()=>{_(),addMessage("ai","Conversation ended. I've saved our discussion and any insights we discovered. Feel free to start a new conversation anytime!"),p.k.info("Voice conversation ended",{component:"voice-chat"})},variant:"destructive",className:"px-8 py-3 rounded-full",children:[a.jsx(m.Z,{className:"w-5 h-5 mr-2"}),"End Conversation"]}):(0,a.jsxs)(n.z,{onClick:handleStartConversation,disabled:!s,className:"bg-green-500 hover:bg-green-600 text-white px-8 py-3 rounded-full",children:[a.jsx(d.Z,{className:"w-5 h-5 mr-2"}),"Start Conversation"]})}),(0,a.jsxs)("div",{className:"flex items-center justify-center space-x-6 mt-4 text-sm text-gray-600",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[a.jsx("div",{className:`w-2 h-2 rounded-full ${k?"bg-red-500 animate-pulse":"bg-gray-300"}`}),a.jsx("span",{children:k?"Recording":"Not Recording"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[a.jsx(h.Z,{className:"w-4 h-4"}),(0,a.jsxs)("span",{children:["AI Voice: ",x]})]}),a.jsx("div",{className:"flex items-center space-x-2",children:(0,a.jsxs)("span",{children:["Messages: ",e.length]})})]})]})}),a.jsx(r.Zb,{className:"bg-blue-50 border-blue-200",children:(0,a.jsxs)(r.aY,{className:"p-4",children:[a.jsx("h3",{className:"font-medium text-blue-900 mb-2",children:"How to use Voice Chat:"}),(0,a.jsxs)("ul",{className:"text-sm text-blue-800 space-y-1",children:[a.jsx("li",{children:'• Click "Start Conversation" to begin talking with your AI assistant'}),a.jsx("li",{children:"• Speak naturally about your networking goals, people you've met, or opportunities"}),a.jsx("li",{children:"• The AI will transcribe your speech and respond with helpful insights"}),a.jsx("li",{children:"• All conversations are automatically saved and analyzed for networking insights"}),a.jsx("li",{children:"• Use the voice settings to change the AI's personality and tone"})]})]})})]})})}},42318:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>r,__esModule:()=>n,default:()=>c});var a=s(95153);let i=(0,a.createProxy)(String.raw`/Users/israelwilson/Developer/rhiz-intent-mvp/apps/web/app/voice-chat/page.tsx`),{__esModule:n,$$typeof:r}=i,o=i.default,c=o}};var t=require("../../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),s=t.X(0,[5467,7691,4995,838],()=>__webpack_exec__(95095));module.exports=s})();