"use strict";(()=>{var e={};e.id=4353,e.ids=[4353],e.modules={30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6113:e=>{e.exports=require("crypto")},57147:e=>{e.exports=require("fs")},41808:e=>{e.exports=require("net")},22037:e=>{e.exports=require("os")},4074:e=>{e.exports=require("perf_hooks")},12781:e=>{e.exports=require("stream")},24404:e=>{e.exports=require("tls")},137:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>m,originalPathname:()=>f,requestAsyncStorage:()=>u,routeModule:()=>c,serverHooks:()=>p,staticGenerationAsyncStorage:()=>d,staticGenerationBailout:()=>g});var a={};r.r(a),r.d(a,{GET:()=>GET,POST:()=>POST});var i=r(10884),n=r(16132),o=r(95798),s=r(37552),l=r(1345);async function GET(e){try{let t=await (0,l.n5)();if(!t)return o.Z.json({error:"Unauthorized"},{status:401});let r=e.nextUrl.searchParams,a=r.get("workspaceId");try{if(a){let e=await s.db.select({id:s.hS.id,title:s.hS.title,kind:s.hS.kind,status:s.hS.status}).from(s.hS).where((0,s.xD)((0,s.eq)(s.hS.workspaceId,a),(0,s.eq)(s.hS.status,"active"))).limit(5),t=await Promise.all(e.map(async e=>{let t=await s.db.select({id:s.Jz.id,aId:s.Jz.aId,bId:s.Jz.bId,score:s.Jz.score,state:s.Jz.state,why:s.Jz.why}).from(s.Jz).where((0,s.xD)((0,s.eq)(s.Jz.goalId,e.id),(0,s.eq)(s.Jz.state,"proposed"))).orderBy((0,s.C8)(s.Jz.score)).limit(3),r=await Promise.all(t.map(async e=>{let[t]=await s.db.select({fullName:s.lB.fullName,primaryEmail:s.lB.primaryEmail,location:s.lB.location}).from(s.lB).where((0,s.eq)(s.lB.id,e.aId)).limit(1),[r]=await s.db.select({fullName:s.lB.fullName,primaryEmail:s.lB.primaryEmail,location:s.lB.location}).from(s.lB).where((0,s.eq)(s.lB.id,e.bId)).limit(1);return{...e,personAName:t?.fullName||"Unknown",personAEmail:t?.primaryEmail,personALocation:t?.location,personBName:r?.fullName||"Unknown",personBEmail:r?.primaryEmail,personBLocation:r?.location}}));return{id:e.id,goalTitle:e.title,goalKind:e.kind,goalStatus:e.status,suggestions:r,insight:{type:"opportunity",message:`${r.length} potential connections identified`,confidence:.8}}}));return o.Z.json({cards:t})}}catch(e){console.log("Database query failed, falling back to mock data:",e)}return o.Z.json({cards:[{id:"1",goalTitle:"Find Technical Co-founder",goalKind:"recruitment",goalStatus:"active",suggestions:[{id:"s1",personName:"Sarah Chen",title:"Senior Software Engineer",company:"TechCorp",score:.92,why:{mutualInterests:["AI/ML","Startups","Product Development"],recency:.8,frequency:.7,affiliation:.9,goalAlignment:.95}},{id:"s2",personName:"Mike Rodriguez",title:"CTO",company:"StartupXYZ",score:.88,why:{mutualInterests:["SaaS","Scaling","Team Building"],recency:.6,frequency:.8,affiliation:.85,goalAlignment:.9}}],insight:{type:"opportunity",message:"High concentration of technical talent in your network",confidence:.85}},{id:"2",goalTitle:"Secure Series A Funding",goalKind:"fundraising",goalStatus:"active",suggestions:[{id:"s3",personName:"David Kim",title:"Partner",company:"Venture Capital",score:.95,why:{mutualInterests:["Fintech","Growth","Investment"],recency:.9,frequency:.6,affiliation:.8,goalAlignment:.98}}],insight:{type:"network_gap",message:"Limited connections to Series A investors",confidence:.75}}]})}catch(e){return console.error("Intent cards API error:",e),o.Z.json({error:"Internal server error"},{status:500})}}async function POST(e){try{let t=await (0,l.n5)();if(!t)return o.Z.json({error:"Unauthorized"},{status:401});let r=await e.json(),{workspaceId:a,goalId:i,action:n,suggestionId:s}=r;if(!a||!i||!n)return o.Z.json({error:"Missing required fields"},{status:400});if("accept"===n&&s)return o.Z.json({success:!0,message:"Suggestion accepted"});if("reject"===n&&s)return o.Z.json({success:!0,message:"Suggestion rejected"});return o.Z.json({error:"Invalid action"},{status:400})}catch(e){return console.error("Intent cards action error:",e),o.Z.json({error:"Internal server error"},{status:500})}}let c=new i.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/intent-cards/route",pathname:"/api/intent-cards",filename:"route",bundlePath:"app/api/intent-cards/route"},resolvedPagePath:"/Users/israelwilson/Developer/rhiz-intent-mvp/apps/web/app/api/intent-cards/route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:u,staticGenerationAsyncStorage:d,serverHooks:p,headerHooks:m,staticGenerationBailout:g}=c,f="/api/intent-cards/route"},1345:(e,t,r)=>{async function getUserId(){return"alice-user-id"}r.d(t,{n5:()=>getUserId})}};var t=require("../../../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),r=t.X(0,[729,5798,9155,7552],()=>__webpack_exec__(137));module.exports=r})();