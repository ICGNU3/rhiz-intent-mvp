"use strict";(()=>{var e={};e.id=6230,e.ids=[6230],e.modules={30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6113:e=>{e.exports=require("crypto")},57147:e=>{e.exports=require("fs")},13685:e=>{e.exports=require("http")},95687:e=>{e.exports=require("https")},41808:e=>{e.exports=require("net")},87561:e=>{e.exports=require("node:fs")},84492:e=>{e.exports=require("node:stream")},72477:e=>{e.exports=require("node:stream/web")},22037:e=>{e.exports=require("os")},71017:e=>{e.exports=require("path")},4074:e=>{e.exports=require("perf_hooks")},85477:e=>{e.exports=require("punycode")},12781:e=>{e.exports=require("stream")},24404:e=>{e.exports=require("tls")},57310:e=>{e.exports=require("url")},73837:e=>{e.exports=require("util")},71267:e=>{e.exports=require("worker_threads")},59796:e=>{e.exports=require("zlib")},35996:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>y,originalPathname:()=>x,requestAsyncStorage:()=>d,routeModule:()=>l,serverHooks:()=>g,staticGenerationAsyncStorage:()=>u,staticGenerationBailout:()=>m});var a={};r.r(a),r.d(a,{POST:()=>POST,dynamic:()=>_});var i=r(10884),o=r(16132),s=r(95798),n=r(37552),c=r(1345),p=r(24095);let _="force-dynamic";async function POST(e){try{let t=await (0,c.n5)();if(!t)return s.Z.json({error:"Unauthorized"},{status:401});let r=await e.json(),{goalId:a,limit:i=10}=r;try{let e;await (0,n.v8)(t);let r=await n.db.select({contact_id:n.pp.contactId,last_interaction_at:n.pp.lastInteractionAt,interactions_90d:n.pp.interactions90d,reciprocity_ratio:n.pp.reciprocityRatio,sentiment_avg:n.pp.sentimentAvg,decay_days:n.pp.decayDays,role_tags:n.pp.roleTags,shared_context_tags:n.pp.sharedContextTags,goal_alignment_score:n.pp.goalAlignmentScore,capacity_cost:n.pp.capacityCost}).from(n.pp).where((0,n.eq)(n.pp.userId,t)),i=r.map(e=>({contact_id:e.contact_id,last_interaction_at:e.last_interaction_at?.toISOString(),interactions_90d:e.interactions_90d,reciprocity_ratio:e.reciprocity_ratio/100,sentiment_avg:e.sentiment_avg/100,decay_days:e.decay_days,role_tags:Array.isArray(e.role_tags)?e.role_tags:[],shared_context_tags:Array.isArray(e.shared_context_tags)?e.shared_context_tags:[],goal_alignment_score:e.goal_alignment_score/100,capacity_cost:e.capacity_cost/100}));if(a){let r=await n.db.select().from(n.hS).where((0,n.xD)((0,n.eq)(n.hS.id,a),(0,n.eq)(n.hS.ownerId,t))).limit(1);r.length>0&&(e={id:r[0].id,description:r[0].details||r[0].title,timeframe:r[0].status})}let o=await n.db.select({count:n.i6`count(*)`}).from(n.lB).where((0,n.eq)(n.lB.ownerId,t)),c={total_contacts:Number(o[0]?.count||0),active_conversations:i.filter(e=>e.interactions_90d>0).length,dunbar_layer_counts:{intimate:0,close:0,meaningful:0,stable:0,extended:0}},_={userId:t,goal:e,signals:i,network_context:c},l=await (0,p.fo)(_);return await n.db.insert(n.M0).values({userId:t,goalId:a,agent:"mapper",action:l.action,payload:l}),s.Z.json(l)}catch(r){console.error("Database query failed:",r);let e=await (0,p.fo)({userId:t,signals:[{contact_id:"1",last_interaction_at:"2024-01-15T00:00:00Z",interactions_90d:12,reciprocity_ratio:.8,sentiment_avg:.7,decay_days:5,role_tags:["engineer","startup"],shared_context_tags:["AI/ML","San Francisco"],goal_alignment_score:.9,capacity_cost:.6}]});return s.Z.json(e)}}catch(e){return console.error("Agent prioritize error:",e),s.Z.json({error:"Internal server error"},{status:500})}}let l=new i.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/agents/prioritize/route",pathname:"/api/agents/prioritize",filename:"route",bundlePath:"app/api/agents/prioritize/route"},resolvedPagePath:"/Users/israelwilson/Developer/rhiz-intent-mvp/apps/web/app/api/agents/prioritize/route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:d,staticGenerationAsyncStorage:u,serverHooks:g,headerHooks:y,staticGenerationBailout:m}=l,x="/api/agents/prioritize/route"}};var t=require("../../../../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),r=t.X(0,[729,5798,9155,1811,7552,7945],()=>__webpack_exec__(35996));module.exports=r})();