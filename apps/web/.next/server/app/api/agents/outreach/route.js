"use strict";(()=>{var e={};e.id=8188,e.ids=[8188],e.modules={30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6113:e=>{e.exports=require("crypto")},57147:e=>{e.exports=require("fs")},13685:e=>{e.exports=require("http")},95687:e=>{e.exports=require("https")},41808:e=>{e.exports=require("net")},87561:e=>{e.exports=require("node:fs")},84492:e=>{e.exports=require("node:stream")},72477:e=>{e.exports=require("node:stream/web")},22037:e=>{e.exports=require("os")},71017:e=>{e.exports=require("path")},4074:e=>{e.exports=require("perf_hooks")},85477:e=>{e.exports=require("punycode")},12781:e=>{e.exports=require("stream")},24404:e=>{e.exports=require("tls")},57310:e=>{e.exports=require("url")},73837:e=>{e.exports=require("util")},71267:e=>{e.exports=require("worker_threads")},59796:e=>{e.exports=require("zlib")},8143:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>f,originalPathname:()=>g,requestAsyncStorage:()=>d,routeModule:()=>p,serverHooks:()=>h,staticGenerationAsyncStorage:()=>_,staticGenerationBailout:()=>m});var o={};r.r(o),r.d(o,{POST:()=>POST,dynamic:()=>c});var a=r(10884),n=r(16132),s=r(95798),i=r(37552),u=r(1345),l=r(24095);let c="force-dynamic";async function POST(e){try{let t=await (0,u.n5)();if(!t)return s.Z.json({error:"Unauthorized"},{status:401});let r=await e.json(),{contact_id:o,goal_id:a,agent_type:n="strategist"}=r;if(!o)return s.Z.json({error:"Contact ID required"},{status:400});try{let e;await (0,i.v8)(t);let r=await i.db.select().from(i.lB).where((0,i.xD)((0,i.eq)(i.lB.id,o),(0,i.eq)(i.lB.ownerId,t))).limit(1);if(0===r.length)return s.Z.json({error:"Contact not found"},{status:404});let u=r[0],c=await i.db.select().from(i.QS).where((0,i.xD)((0,i.eq)(i.QS.subjectId,o),(0,i.eq)(i.QS.subjectType,"person"),(0,i.eq)(i.QS.ownerId,t))).orderBy((0,i.C8)(i.QS.confidence));if(a){let r=await i.db.select().from(i.hS).where((0,i.xD)((0,i.eq)(i.hS.id,a),(0,i.eq)(i.hS.ownerId,t))).limit(1);r.length>0&&(e={id:r[0].id,description:r[0].details||r[0].title,urgency:7,mutual_benefit_potential:8})}let p=await i.db.select().from(i.qU).where((0,i.eq)(i.qU.ownerId,t)).orderBy((0,i.C8)(i.qU.occurredAt)).limit(10),d=c.filter(e=>"interests"===e.key).map(e=>e.value),_=c.filter(e=>"expertise"===e.key).map(e=>e.value),h={interaction_count:p.length,average_response_time:24,preferred_topics:[...d,..._],successful_outreach_patterns:["professional","helpful"],last_positive_interaction:p[0]?.occurredAt.toISOString()};if("strategist"===n){let r={userId:t,target_contact:{contact_id:u.id,relationship_strength:7,dunbar_layer:3,last_interaction_at:p[0]?.occurredAt.toISOString(),preferred_channels:["email"],communication_style:"professional",timezone:"US/Pacific"},goal_context:e,relationship_history:h,current_context:{season:"Q1",user_availability:"normal",recent_life_events:[]}},o=await (0,l.Hr)(r);return await i.db.insert(i.M0).values({userId:t,goalId:a||null,agent:"strategist",action:o.action,payload:o}),s.Z.json(o)}if("storyweaver"===n){let r={userId:t,target_contact:{contact_id:u.id,full_name:u.fullName,relationship_strength:7,dunbar_layer:3,communication_preferences:{formality_level:"professional",preferred_topics:h.preferred_topics,response_patterns:["thoughtful","detailed"],tone_preferences:"warm professional"}},relationship_context:{shared_history:p.map(e=>e.summary||""),mutual_connections:[],shared_interests:d,recent_developments:[],last_conversation_topics:h.preferred_topics,successful_interaction_patterns:h.successful_outreach_patterns},outreach_intent:{primary_goal:e?.description||"Reconnect and explore collaboration",mutual_benefit:"Knowledge sharing and potential collaboration",urgency_level:5,desired_outcome:"Schedule a coffee chat to catch up"},contextual_hooks:{recent_achievements:[],shared_experiences:[],mutual_interests_updates:d,industry_developments:[],seasonal_opportunities:[]}},o=await (0,l.dL)(r);return await i.db.insert(i.M0).values({userId:t,goalId:a||null,agent:"storyweaver",action:o.action,payload:o}),s.Z.json(o)}return s.Z.json({error:"Invalid agent type"},{status:400})}catch(e){return console.error("Database query failed:",e),s.Z.json({action:"outreach_plan",contact_id:o,subject:"Quick catch-up over coffee?",message_draft:"Hi there! Hope you&apos;ve been doing well. I&apos;d love to catch up and hear about what you&apos;ve been working on lately. Would you be interested in grabbing coffee sometime in the next couple weeks?",follow_up_days:14})}}catch(e){return console.error("Agent outreach error:",e),s.Z.json({error:"Internal server error"},{status:500})}}let p=new a.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/agents/outreach/route",pathname:"/api/agents/outreach",filename:"route",bundlePath:"app/api/agents/outreach/route"},resolvedPagePath:"/Users/israelwilson/Developer/rhiz-intent-mvp/apps/web/app/api/agents/outreach/route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:d,staticGenerationAsyncStorage:_,serverHooks:h,headerHooks:f,staticGenerationBailout:m}=p,g="/api/agents/outreach/route"}};var t=require("../../../../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),r=t.X(0,[729,5798,9155,1811,7552,7945],()=>__webpack_exec__(8143));module.exports=r})();