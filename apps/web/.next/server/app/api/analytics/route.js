"use strict";(()=>{var e={};e.id=1567,e.ids=[1567],e.modules={30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6113:e=>{e.exports=require("crypto")},57147:e=>{e.exports=require("fs")},41808:e=>{e.exports=require("net")},22037:e=>{e.exports=require("os")},4074:e=>{e.exports=require("perf_hooks")},12781:e=>{e.exports=require("stream")},24404:e=>{e.exports=require("tls")},39009:(e,t,a)=>{a.r(t),a.d(t,{headerHooks:()=>g,originalPathname:()=>m,requestAsyncStorage:()=>l,routeModule:()=>d,serverHooks:()=>p,staticGenerationAsyncStorage:()=>u,staticGenerationBailout:()=>h});var r={};a.r(r),a.d(r,{GET:()=>GET,dynamic:()=>i});var o=a(10884),s=a(16132),c=a(95798),n=a(37552);let i="force-dynamic";async function GET(e){try{let{searchParams:t}=new URL(e.url),a=t.get("workspaceId"),r=t.get("period")||"30";if(!a)return c.Z.json({error:"Workspace ID is required"},{status:400});let o="demo"===a?"550e8400-e29b-41d4-a716-446655440001":a;try{Date.now(),parseInt(r);let e=await n.db.select({createdAt:n.Jz.createdAt,state:n.Jz.state}).from(n.Jz).where((0,n.eq)(n.Jz.workspaceId,o)).orderBy((0,n.C8)(n.Jz.createdAt)),t=await n.db.select({status:n.hS.status}).from(n.hS).where((0,n.eq)(n.hS.workspaceId,o)),a=await n.db.select({id:n.lB.id}).from(n.lB).where((0,n.eq)(n.lB.workspaceId,o)),s=e.reduce((e,t)=>{let a=new Date(t.createdAt).toISOString().split("T")[0];return e[a]||(e[a]={total:0,accepted:0,completed:0}),e[a].total+=1,"accepted"===t.state&&(e[a].accepted+=1),"completed"===t.state&&(e[a].completed+=1),e},{}),i=t.reduce((e,t)=>(e[t.status]=(e[t.status]||0)+1,e),{});return c.Z.json({networkGrowth:[{date:"2024-01-01",count:5},{date:"2024-01-02",count:3},{date:"2024-01-03",count:7}],introductionsData:Object.entries(s).map(([e,t])=>({date:e,...t})),goalProgress:Object.entries(i).map(([e,t])=>({status:e,count:t})),dormantRelationships:[{date:"2024-01-01",count:2},{date:"2024-01-02",count:1},{date:"2024-01-03",count:3}],metrics:{totalContacts:a.length,totalSuggestions:e.length,acceptedSuggestions:e.filter(e=>"accepted"===e.state).length,activeGoals:t.filter(e=>"active"===e.status).length,acceptanceRate:e.length>0?Math.round(e.filter(e=>"accepted"===e.state).length/e.length*100):0}})}catch(e){return console.error("Database error:",e),c.Z.json({networkGrowth:[{date:"2024-01-01",count:5},{date:"2024-01-02",count:3},{date:"2024-01-03",count:7}],introductionsData:[{date:"2024-01-01",total:2,accepted:1,completed:0},{date:"2024-01-02",total:3,accepted:2,completed:1},{date:"2024-01-03",total:1,accepted:1,completed:0}],goalProgress:[{status:"active",count:3},{status:"completed",count:1}],dormantRelationships:[{date:"2024-01-01",count:2},{date:"2024-01-02",count:1},{date:"2024-01-03",count:3}],metrics:{totalContacts:25,totalSuggestions:6,acceptedSuggestions:4,activeGoals:3,acceptanceRate:67}})}}catch(e){return console.error("Error fetching analytics:",e),c.Z.json({error:"Failed to fetch analytics"},{status:500})}}let d=new o.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/analytics/route",pathname:"/api/analytics",filename:"route",bundlePath:"app/api/analytics/route"},resolvedPagePath:"/Users/israelwilson/Developer/rhiz-intent-mvp/apps/web/app/api/analytics/route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:l,staticGenerationAsyncStorage:u,serverHooks:p,headerHooks:g,staticGenerationBailout:h}=d,m="/api/analytics/route"}};var t=require("../../../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),a=t.X(0,[729,5798,9155,7552],()=>__webpack_exec__(39009));module.exports=a})();