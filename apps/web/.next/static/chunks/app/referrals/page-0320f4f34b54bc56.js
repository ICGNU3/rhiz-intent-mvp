(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[700],{49314:function(e,t,s){Promise.resolve().then(s.bind(s,85304))},85304:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return ReferralsPage}});var r=s(57437),n=s(2265),a=s(49598),i=s(23611),l=s(70708),d=s(35831),c=s(50446),o=s(29764),u=s(56224),f=s(56643),x=s(25750),m=s(85790),h=s(45253),v=s(54295),p=s(20556),g=s(84051),j=s(28485),b=s(36612);function ReferralsPage(){var e,t,s;let[y,N]=(0,n.useState)(""),[w,S]=(0,n.useState)(""),[R,I]=(0,n.useState)({totalInvites:0,successfulSignups:0,earnedRewards:0,invitesRemaining:10}),[T,k]=(0,n.useState)([]),[O,Z]=(0,n.useState)([]),[C,D]=(0,n.useState)(!0),{toast:E}=(0,c.pm)();(0,n.useEffect)(()=>{loadReferralData()},[]);let loadReferralData=async()=>{try{D(!0);let e=await fetch("/api/referrals",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"create",rewardType:"invite",rewardValue:1})});if(e.ok){let{referralCode:t}=await e.json();N(t.code),S("".concat(window.location.origin,"/signup?ref=").concat(t.code))}let t=await fetch("/api/referrals/tree?userId=".concat("current-user-id","&depth=3"));if(t.ok){let{data:e}=await t.json();k(e.tree),Z(e.stats),I(t=>({...t,totalInvites:e.totals.totalInvitees,successfulSignups:e.totals.totalInvitees}))}}catch(e){console.error("Error loading referral data:",e),E({title:"Error",description:"Failed to load referral data",variant:"destructive"})}finally{D(!1)}},copyReferralLink=async()=>{try{await navigator.clipboard.writeText(w),E({title:"Copied!",description:"Referral link copied to clipboard"})}catch(e){E({title:"Error",description:"Failed to copy link",variant:"destructive"})}},shareReferralLink=async()=>{if(navigator.share)try{await navigator.share({title:"Join me on Rhiz",text:"I'm using Rhiz to build better relationships. Join me with this referral link!",url:w})}catch(e){console.log("Share cancelled")}else copyReferralLink()},A=[{name:"Direct Invites",value:(null===(e=O.find(e=>1===e.level))||void 0===e?void 0:e.count)||0,fill:"#3b82f6"},{name:"Level 2",value:(null===(t=O.find(e=>2===e.level))||void 0===t?void 0:t.count)||0,fill:"#8b5cf6"},{name:"Level 3",value:(null===(s=O.find(e=>3===e.level))||void 0===s?void 0:s.count)||0,fill:"#ec4899"}],_=[{name:"Successful",value:R.successfulSignups,fill:"#10b981"},{name:"Pending",value:R.totalInvites-R.successfulSignups,fill:"#f59e0b"}];return(0,r.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsx)("h1",{className:"text-4xl font-bold text-foreground mb-4",children:"Referrals & Invites"}),(0,r.jsx)("p",{className:"text-lg text-muted-foreground",children:"Grow your network and earn rewards by inviting others to Rhiz"})]}),C?(0,r.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,r.jsx)("div",{className:"text-lg",children:"Loading referral data..."})}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(a.Zb,{className:"mb-8",children:[(0,r.jsxs)(a.Ol,{children:[(0,r.jsxs)(a.ll,{className:"flex items-center gap-2",children:[(0,r.jsx)(o.Z,{className:"h-5 w-5"}),"Your Referral Link"]}),(0,r.jsx)(a.SZ,{children:"Share this link with friends and colleagues to earn rewards"})]}),(0,r.jsxs)(a.aY,{children:[(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(d.I,{value:w,readOnly:!0,className:"flex-1",placeholder:"Generating referral link..."}),(0,r.jsx)(i.z,{onClick:copyReferralLink,variant:"outline",children:(0,r.jsx)(u.Z,{className:"h-4 w-4"})}),(0,r.jsxs)(i.z,{onClick:shareReferralLink,children:[(0,r.jsx)(o.Z,{className:"h-4 w-4 mr-2"}),"Share"]})]}),(0,r.jsxs)("div",{className:"mt-4 flex items-center gap-4 text-sm text-muted-foreground",children:[(0,r.jsx)("div",{className:"flex items-center gap-1",children:(0,r.jsxs)(l.C,{variant:"secondary",children:["Code: ",y]})}),!1,(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)(x.Z,{className:"h-4 w-4"}),(0,r.jsxs)("span",{children:[R.invitesRemaining," invites remaining"]})]})]})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[(0,r.jsxs)(a.Zb,{children:[(0,r.jsxs)(a.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,r.jsx)(a.ll,{className:"text-sm font-medium",children:"Total Invites"}),(0,r.jsx)(x.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,r.jsxs)(a.aY,{children:[(0,r.jsx)("div",{className:"text-2xl font-bold",children:R.totalInvites}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"People you've invited"})]})]}),(0,r.jsxs)(a.Zb,{children:[(0,r.jsxs)(a.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,r.jsx)(a.ll,{className:"text-sm font-medium",children:"Successful Signups"}),(0,r.jsx)(m.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,r.jsxs)(a.aY,{children:[(0,r.jsx)("div",{className:"text-2xl font-bold",children:R.successfulSignups}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"Who joined with your link"})]})]}),(0,r.jsxs)(a.Zb,{children:[(0,r.jsxs)(a.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,r.jsx)(a.ll,{className:"text-sm font-medium",children:"Earned Rewards"}),(0,r.jsx)(f.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,r.jsxs)(a.aY,{children:[(0,r.jsx)("div",{className:"text-2xl font-bold",children:R.earnedRewards}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"Rewards earned"})]})]}),(0,r.jsxs)(a.Zb,{children:[(0,r.jsxs)(a.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,r.jsx)(a.ll,{className:"text-sm font-medium",children:"Conversion Rate"}),(0,r.jsx)(m.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,r.jsxs)(a.aY,{children:[(0,r.jsxs)("div",{className:"text-2xl font-bold",children:[R.totalInvites>0?Math.round(R.successfulSignups/R.totalInvites*100):0,"%"]}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"Signup success rate"})]})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,r.jsxs)(a.Zb,{children:[(0,r.jsxs)(a.Ol,{children:[(0,r.jsx)(a.ll,{children:"Your Invite Tree"}),(0,r.jsx)(a.SZ,{children:"Visual representation of your network growth"})]}),(0,r.jsxs)(a.aY,{children:[(0,r.jsx)("div",{className:"h-64",children:(0,r.jsx)(h.h,{width:"100%",height:"100%",children:(0,r.jsx)(v.B,{data:A,innerRadius:"20%",outerRadius:"100%",children:(0,r.jsx)(p.G,{dataKey:"value",cornerRadius:10})})})}),(0,r.jsx)("div",{className:"mt-4 space-y-2",children:O.map(e=>(0,r.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,r.jsxs)("span",{children:["Level ",e.level," Invites:"]}),(0,r.jsx)("span",{className:"font-medium",children:e.count})]},e.level))})]})]}),(0,r.jsxs)(a.Zb,{children:[(0,r.jsxs)(a.Ol,{children:[(0,r.jsx)(a.ll,{children:"Signup Distribution"}),(0,r.jsx)(a.SZ,{children:"Breakdown of successful vs pending signups"})]}),(0,r.jsxs)(a.aY,{children:[(0,r.jsx)("div",{className:"h-64",children:(0,r.jsx)(h.h,{width:"100%",height:"100%",children:(0,r.jsx)(g.u,{children:(0,r.jsx)(j.b,{data:_,cx:"50%",cy:"50%",innerRadius:60,outerRadius:80,paddingAngle:5,dataKey:"value",children:_.map((e,t)=>(0,r.jsx)(b.b,{fill:e.fill},"cell-".concat(t)))})})})}),(0,r.jsx)("div",{className:"mt-4 space-y-2",children:_.map(e=>(0,r.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,r.jsxs)("span",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:e.fill}}),e.name,":"]}),(0,r.jsx)("span",{className:"font-medium",children:e.value})]},e.name))})]})]})]}),(0,r.jsxs)(a.Zb,{className:"mt-8",children:[(0,r.jsxs)(a.Ol,{children:[(0,r.jsx)(a.ll,{children:"Recent Activity"}),(0,r.jsx)(a.SZ,{children:"Latest invites and signups from your network"})]}),(0,r.jsx)(a.aY,{children:T.length>0?(0,r.jsx)("div",{className:"space-y-4",children:T.slice(0,5).map((e,t)=>(0,r.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:"w-8 h-8 bg-primary/10 rounded-full flex items-center justify-center",children:(0,r.jsx)(x.Z,{className:"h-4 w-4 text-primary"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"font-medium",children:e.isDirectInvitee?"Direct Invite":"Level ".concat(e.level," Invite")}),(0,r.jsxs)("div",{className:"text-sm text-muted-foreground",children:["User ID: ",e.inviteeId.slice(0,8),"..."]})]})]}),(0,r.jsx)(l.C,{variant:e.isDirectInvitee?"default":"secondary",children:e.isDirectInvitee?"Direct":"Level ".concat(e.level)})]},t))}):(0,r.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[(0,r.jsx)(x.Z,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),(0,r.jsx)("p",{children:"No invites yet. Share your referral link to get started!"})]})})]})]})]})}},70708:function(e,t,s){"use strict";s.d(t,{C:function(){return Badge}});var r=s(57437);s(2265);var n=s(96061),a=s(81628);let i=(0,n.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function Badge(e){let{className:t,variant:s,...n}=e;return(0,r.jsx)("div",{className:(0,a.cn)(i({variant:s}),t),...n})}},23611:function(e,t,s){"use strict";s.d(t,{z:function(){return c}});var r=s(57437),n=s(2265),a=s(67256),i=s(96061),l=s(81628);let d=(0,i.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=n.forwardRef((e,t)=>{let{className:s,variant:n,size:i,asChild:c=!1,...o}=e,u=c?a.g7:"button";return(0,r.jsx)(u,{className:(0,l.cn)(d({variant:n,size:i,className:s})),ref:t,...o})});c.displayName="Button"},49598:function(e,t,s){"use strict";s.d(t,{Ol:function(){return l},SZ:function(){return c},Zb:function(){return i},aY:function(){return o},ll:function(){return d}});var r=s(57437),n=s(2265),a=s(81628);let i=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,r.jsx)("div",{ref:t,className:(0,a.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",s),...n})});i.displayName="Card";let l=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,r.jsx)("div",{ref:t,className:(0,a.cn)("flex flex-col space-y-1.5 p-6",s),...n})});l.displayName="CardHeader";let d=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,r.jsx)("h3",{ref:t,className:(0,a.cn)("text-2xl font-semibold leading-none tracking-tight",s),...n})});d.displayName="CardTitle";let c=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,r.jsx)("p",{ref:t,className:(0,a.cn)("text-sm text-muted-foreground",s),...n})});c.displayName="CardDescription";let o=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,r.jsx)("div",{ref:t,className:(0,a.cn)("p-6 pt-0",s),...n})});o.displayName="CardContent";let u=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,r.jsx)("div",{ref:t,className:(0,a.cn)("flex items-center p-6 pt-0",s),...n})});u.displayName="CardFooter"},35831:function(e,t,s){"use strict";s.d(t,{I:function(){return i}});var r=s(57437),n=s(2265),a=s(81628);let i=n.forwardRef((e,t)=>{let{className:s,type:n,...i}=e;return(0,r.jsx)("input",{type:n,className:(0,a.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),ref:t,...i})});i.displayName="Input"},50446:function(e,t,s){"use strict";s.d(t,{pm:function(){return useToast}});var r=s(2265);let n=0;function genId(){return(n=(n+1)%Number.MAX_SAFE_INTEGER).toString()}let a=new Map,addToRemoveQueue=e=>{if(a.has(e))return;let t=setTimeout(()=>{a.delete(e),dispatch({type:"REMOVE_TOAST",toastId:e})},1e6);a.set(e,t)},reducer=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:s}=t;return s?addToRemoveQueue(s):e.toasts.forEach(e=>{addToRemoveQueue(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===s||void 0===s?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},i=[],l={toasts:[]};function dispatch(e){l=reducer(l,e),i.forEach(e=>{e(l)})}function toast(e){let{...t}=e,s=genId(),dismiss=()=>dispatch({type:"DISMISS_TOAST",toastId:s});return dispatch({type:"ADD_TOAST",toast:{...t,id:s,open:!0,onOpenChange:e=>{e||dismiss()}}}),{id:s,dismiss,update:e=>dispatch({type:"UPDATE_TOAST",toast:{...e,id:s}})}}function useToast(){let[e,t]=r.useState(l);return r.useEffect(()=>(i.push(t),()=>{let e=i.indexOf(t);e>-1&&i.splice(e,1)}),[e]),{...e,toast,dismiss:e=>dispatch({type:"DISMISS_TOAST",toastId:e})}}},81628:function(e,t,s){"use strict";s.d(t,{cn:function(){return cn}});var r=s(57042),n=s(74769);function cn(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,n.m6)((0,r.W)(t))}}},function(e){e.O(0,[723,739,64,150,971,472,744],function(){return e(e.s=49314)}),_N_E=e.O()}]);